SELECT employee_id, department_id
FROM Employee
WHERE primary_flag='Y' OR 
    employee_id in
    (SELECT employee_id
    FROM Employee
    Group by employee_id
    having count(employee_id)=1)


âœ… Objective:
We want to return each employee with their "primary" department.

That means:

If the employee has a row with primary_flag = 'Y', return that row.

If the employee is in only one department, return that row (even though primary_flag = 'N').
